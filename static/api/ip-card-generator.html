<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IP Card Generator</title>
</head>
<body>
    <canvas id="ipCard" width="200" height="400"></canvas>

    <script>
        // Generate IP card as PNG
        async function generateIPCard() {
            // Get IP address once
            let ipAddress = '127.0.0.1'; // fallback
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                ipAddress = data.ip;
            } catch (error) {
                console.error('Failed to get IP:', error);
            }

            // Get current time once
            const now = new Date();
            const timeString = now.toLocaleString('en-US', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            }).replace(',', '');

            // Canvas setup
            const canvas = document.getElementById('ipCard');
            const ctx = canvas.getContext('2d');

            // Background
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, 200, 400);

            // Linux Logo Circle
            ctx.fillStyle = '#4CAF50';
            ctx.beginPath();
            ctx.arc(100, 60, 20, 0, 2 * Math.PI);
            ctx.fill();

            // Linux Logo Text
            ctx.fillStyle = 'white';
            ctx.font = 'bold 18px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('L', 100, 68);

            // Linux.wiki text
            ctx.fillStyle = '#4CAF50';
            ctx.font = 'bold 16px Arial';
            ctx.fillText('linux.wiki', 100, 100);

            // IP Address
            ctx.fillStyle = '#4CAF50';
            ctx.font = 'bold 18px Monaco, Consolas, monospace';
            ctx.fillText(ipAddress, 100, 200);

            // Generation Time
            ctx.fillStyle = '#888888';
            ctx.font = '10px Monaco, Consolas, monospace';
            ctx.fillText(timeString, 100, 360);

            // Convert to PNG and serve as image
            return canvas.toDataURL('image/png');
        }

        // Generate and serve the image
        generateIPCard().then(dataUrl => {
            // Convert dataUrl to blob and create object URL
            const img = new Image();
            img.onload = function() {
                // Create download
                const link = document.createElement('a');
                link.download = 'ip-card.png';
                link.href = dataUrl;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            };
            img.src = dataUrl;
        });
    </script>
</body>
</html>